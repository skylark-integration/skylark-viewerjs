/**
 * skylark-viewerjs - A version of viewerjs that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./viewerjs"],function(t){"use strict";var e=function(){var t=["ms","Moz","Webkit","O"],e={};function i(){}return i.getProp=function(i,n){if(1===arguments.length&&"string"==typeof e[i])return e[i];var r,s,o=(n=n||document.documentElement).style;if("string"==typeof o[i])return e[i]=i;s=i.charAt(0).toUpperCase()+i.slice(1);for(var a=0,l=t.length;a<l;a++)if("string"==typeof o[r=t[a]+s])return e[i]=r;return e[i]="undefined"},i.setProp=function(t,e,i){var n=this.getProp(t);"undefined"!==n&&(e.style[n]=i)},i}();function i(t,e){var i=0,n=t.length-1;if(0===t.length||!e(t[n]))return t.length;if(e(t[i]))return i;for(;i<n;){var r=i+n>>1;e(t[r])?n=r:i=r+1}return i}var n=function(){function t(t,e){this.visible=!0,this.div=document.querySelector(t+" .progress"),this.bar=this.div.parentNode,this.height=e.height||100,this.width=e.width||100,this.units=e.units||"%",this.div.style.height=this.height+this.units,this.percent=0}return t.prototype={updateBar:function(){if(this._indeterminate)return this.div.classList.add("indeterminate"),void(this.div.style.width=this.width+this.units);this.div.classList.remove("indeterminate");var t=this.width*this._percent/100;this.div.style.width=t+this.units},get percent(){return this._percent},set percent(t){var e,i,n;this._indeterminate=isNaN(t),this._percent=(e=t,i=0,n=100,Math.min(Math.max(e,i),n)),this.updateBar()},setWidth:function(t){if(t){var e=t.parentNode.offsetWidth-t.offsetWidth;e>0&&this.bar.setAttribute("style","width: calc(100% - "+e+"px);")}},hide:function(){this.visible&&(this.visible=!1,this.bar.classList.add("hidden"),document.body.classList.remove("loadingInProgress"))},show:function(){this.visible||(this.visible=!0,document.body.classList.add("loadingInProgress"),this.bar.classList.remove("hidden"))}},t}();return t.uiutils={CustomStyle:e,getFileName:function(t){var e=t.indexOf("#"),i=t.indexOf("?"),n=Math.min(e>0?e:t.length,i>0?i:t.length);return t.substring(t.lastIndexOf("/",n)+1,n)},getOutputScale:function(t){var e=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1);return{sx:e,sy:e,scaled:1!==e}},scrollIntoView:function(t,e){var i=t.offsetParent,n=t.offsetTop+t.clientTop,r=t.offsetLeft+t.clientLeft;if(i){for(;i.clientHeight===i.scrollHeight;)if(i.dataset._scaleY&&(n/=i.dataset._scaleY,r/=i.dataset._scaleX),n+=i.offsetTop,r+=i.offsetLeft,!(i=i.offsetParent))return;e&&(void 0!==e.top&&(n+=e.top),void 0!==e.left&&(r+=e.left,i.scrollLeft=r)),i.scrollTop=n}else console.error("offsetParent is not set -- cannot scroll")},watchScroll:function(t,e){var i=function(i){r||(r=window.requestAnimationFrame(function(){r=null;var i=t.scrollTop,s=n.lastY;i!==s&&(n.down=i>s),n.lastY=i,e(n)}))},n={down:!0,lastY:t.scrollTop,_eventHandler:i},r=null;return t.addEventListener("scroll",i,!0),n},binarySearchFirstItem:i,getVisibleElements:function(t,e,n){for(var r,s,o,a,l,c,d=t.scrollTop,f=d+t.clientHeight,h=t.scrollLeft,u=h+t.clientWidth,v=[],p=0===e.length?0:i(e,function(t){var e=t.div;return e.offsetTop+e.clientTop+e.clientHeight>d}),g=e.length;p<g&&(o=(s=(r=e[p]).div).offsetTop+s.clientTop,a=s.clientHeight,!(o>f));p++)(c=s.offsetLeft+s.clientLeft)+s.clientWidth<h||c>u||(l=100*(a-(Math.max(0,d-o)+Math.max(0,o+a-f)))/a|0,v.push({id:r.id,x:c,y:o,view:r,percent:l}));var m=v[0],b=v[v.length-1];return n&&v.sort(function(t,e){var i=t.percent-e.percent;return Math.abs(i)>.001?-i:t.id-e.id}),{first:m,last:b,views:v}},getPDFFileNameFromURL:function(t){var e=/[^\/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=/^(?:([^:]+:)?\/\/[^\/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(t),n=e.exec(i[1])||e.exec(i[2])||e.exec(i[3]);if(n&&-1!==(n=n[0]).indexOf("%"))try{n=e.exec(decodeURIComponent(n))[0]}catch(t){}return n||"document.pdf"},ProgressBar:n}});
//# sourceMappingURL=sourcemaps/ui_utils.js.map
